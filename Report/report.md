# Отчет по работе с Линуксом

## Создание контейнеров в Play-with-docker

Работа проводилась в среде Play-with-docker.

Сначала добавим три контейнера, нажав кнопку `ADD NEW INSTANCE`.

После добавления контейнеров интерфейс будет выглядеть следующим образом:

![img.png](img.png)

Для работы с ними подключимся к каждому контейнеру через терминалы с использованием SSH-соединений.

![img_1.png](img_1.png)

Теперь настроим сеть с использованием ipvlan. Добавим по одному сетевому адаптеру к каждому из контейнеров A и C:

- ВМ A: IP-адрес 192.168.30.10 с маской 255.255.255.0
- ВМ C: IP-адрес 192.168.7.100 с маской 255.255.255.0  


![img_11.png](img_11.png)

![img_12.png](img_12.png)
Также добавляем 2 адаптера контейнеру B:

![img_13.png](img_13.png)

### Маршрутизация
Теперь настроим маршрутизацию. Укажем контейнеру A отправлять пакеты к контейнеру C через адаптер `macvlan1`, который находится на контейнере B.

- Контейнер A: ip route add 192.168.7.0/24 via 192.168.30.1 

Для контейнера С сделаем наоборот

- Контейнер C: ip route add 192.168.30.0/24 via 192.168.7.1

![img_14.png](img_14.png)

![img_15.png](img_15.png)

сделаем пинг

![img_16.png](img_16.png)

## Создание и запуск сервера

Так как был выбран язык Go для реализации задания то установим его и проверим.

Для этого выполним команды
- apk update
- apk add go 
- 
![img_6.png](img_6.png)

запустим сервер

![img_7.png](img_7.png)

Теперь проверим работу GET, POST, PUT запросов.

# Описание сервиса 
### Описание сервиса сокращения URL

Сервис сокращения URL позволяет пользователям преобразовывать длинные URL-адреса в короткие, которые легче запоминать и делиться. Он предоставляет несколько основных функций, включая создание коротких URL, перенаправление на оригинальные URL, отображение всех сокращенных URL и обновление существующих URL.

#### Основные функции:

1. **Сокращение URL**:
    - Метод: `POST`
    - Эндпоинт: `/shorten`
    - Описание: Пользователь отправляет оригинальный URL, и сервис возвращает сокращенный URL. Сокращенный URL имеет формат `http://localhost:8080/{id}`, где `{id}` — уникальный идентификатор, присвоенный оригинальному URL.

2. **Перенаправление на оригинальный URL**:
    - Метод: `GET`
    - Эндпоинт: `/`
    - Описание: При обращении к сокращенному URL (например, `http://localhost:8080/1`), сервис перенаправляет пользователя на оригинальный URL, связанный с этим идентификатором.

3. **Отображение всех сокращенных URL**:
    - Метод: `GET`
    - Эндпоинт: `/map`
    - Описание: Возвращает JSON-объект, содержащий все сокращенные URL и их соответствующие оригинальные URL. Это позволяет пользователям видеть все их сокращенные ссылки.

4. **Обновление существующего URL**:
    - Метод: `PUT`
    - Эндпоинт: `/update/{id}`
    - Описание: Пользователь может обновить оригинальный URL, связанный с определенным идентификатором. Для этого необходимо указать новый URL в теле запроса.

#### Пример использования:
1. **Сокращение URL**:
    - Запрос: `POST /shorten` с телом `url=http://youtube.com`
    - Ответ: `Shortened URL: http://localhost:8080/1`

2. **Перенаправление**:
    - Запрос: `GET /1`
    - Ответ: Перенаправление на `http://youtube.com`

3. **Отображение всех URL**:
    - Запрос: `GET /map`
    - Ответ: `{"1": "http://youtube.com"}`

4. **Обновление URL**:
    - Запрос: `PUT /update/1` с телом `url=https://github.com/play-with-docker/play-with-docker/issues/159`
    - Ответ: `Updated URL for 1 to https://github.com/play-with-docker/play-with-docker/issues/159`

# Проделаем все шаги на контейнерах

# 1. Post 

![img_18.png](img_18.png)![img_17.png](img_17.png)
```ssh
curl -X POST http://192.168.30.10:8080/shorten -d "url=http://youtube.com"
```
Создадим в мапе новое значение с скоращенной ссылкой

# 2. Get

```ssh
curl -L http://192.168.30.10:8080/2
```

![img_20.png](img_20.png)
Возвращает страцу которая ранее была добавлена в мапу

```ssh
curl  http://192.168.30.10:8080/map
```

Возвращает все сохраненные ссылки 

![img_19.png](img_19.png)

# 3. Put

```ssh
curl -X PUT http://192.168.30.10:8080/update/2 -d "url=http://vk.com"
```
Обновим существующее значение в мапе 

![img_21.png](img_21.png)